@use '../deathbox-theme.scss' as db;

:host {
  display: block;
  font-family: 'Press Start 2P', monospace;
  background-color: db.$void-black;
  padding: 1.5rem;
  // border: 2px solid db.$glitch-purple;
  // border-radius: 6px;
  color: db.$neon-skull-green;
  max-width: 480px;
  margin: 0 auto;
  text-align: center;
  // box-shadow: 0 0 12px rgba(db.$glitch-purple, 0.6);
  animation: retro-open 0.6s ease-out;
}

/* === TEXT STYLING === */
.title-glitch {
  font-size: 1.2rem;
  text-transform: uppercase;
  color: db.$neon-skull-green;
  text-shadow: 
    1px 0 db.$crimson-glitch-red,
   -1px 0 db.$glitch-purple,
    0 0 6px db.$neon-skull-green;
  animation: title-flicker 2.2s infinite;
}

.flavor {
  font-size: 0.8rem;
  color: db.$toxic-mint;
  margin: 0.5rem 0;
  text-shadow: 0 0 4px rgba(db.$toxic-mint,0.5);
}

.ominous {
  font-size: 0.75rem;
  color: db.$crimson-glitch-red;
  text-shadow: 0 0 6px rgba(db.$crimson-glitch-red, 0.7);
  animation: prayer-glow 3s ease-in-out infinite;
}

/* === CRT COUNTER === */
.crt-counter {
  position: relative;
  width: 100%;
  height: 220px;
  margin: 1.5rem auto;
  border: 4px solid db.$glitch-purple;
  background: #000;
  overflow: hidden;
  image-rendering: pixelated;
  box-shadow: 
    0 0 6px db.$glitch-purple,
    inset 0 0 12px rgba(57,255,20,0.2);

  /* rolling scanlines */
  &::before {
    content: '';
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      to bottom,
      rgba(255,255,255,0.05) 0px,
      rgba(255,255,255,0.02) 2px,
      transparent 4px
    );
    mix-blend-mode: overlay;
    opacity: 0.35;
    animation: crt-roll 6s linear infinite;
  }

  /* cursed vignette */
  &::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, transparent 70%, rgba(0,0,0,0.5) 100%);
    pointer-events: none;
  }
}

/* draining fill bar */
.fill-bar {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  transition: height 0.3s ease-out;
  background: linear-gradient(to top, rgba(57,255,20,0.8), rgba(0,184,92,0.65));
  z-index: 1;
}

/* pixel skull lurking */
.skull-bg {
  position: absolute;
  inset: 0;
  background: url('../../assets/skull.png') center/55% no-repeat;
  opacity: 0.12;
  z-index: 0;
  filter: brightness(0.7) contrast(1.5) grayscale(0.8);
  animation: skull-pulse 4s ease-in-out infinite;
}

/* countdown digits */
.timer {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 3.8rem;
  color: db.$neon-skull-green;
  text-shadow: 
    2px 0 db.$crimson-glitch-red,
   -2px 0 db.$glitch-purple,
    0 0 6px db.$neon-skull-green;
  z-index: 2;
  animation: crt-glitch 1.8s infinite steps(2, start);
}

/* corner pixel accents */
.corner {
  position: absolute;
  width: 12px;
  height: 12px;
  border: 2px solid db.$glitch-purple;
}
.corner.tl { top: 0; left: 0; border-right: none; border-bottom: none; }
.corner.tr { top: 0; right: 0; border-left: none; border-bottom: none; }
.corner.bl { bottom: 0; left: 0; border-right: none; border-top: none; }
.corner.br { bottom: 0; right: 0; border-left: none; border-top: none; }

/* === Animations === */
@keyframes retro-open {
  0% { opacity: 0; transform: scale(0.9); filter: blur(6px); }
  25% { opacity: 0.5; transform: scale(1.02); filter: blur(2px); }
  50% { opacity: 1; transform: scale(0.98); filter: blur(1px); }
  100% { opacity: 1; transform: scale(1); filter: none; }
}
@keyframes crt-roll {
  0% { background-position-y: 0; }
  100% { background-position-y: 100%; }
}
@keyframes crt-glitch {
  0%,100% { transform: translate(0,0); }
  20% { transform: translate(-1px,1px); }
  40% { transform: translate(2px,-1px); }
  60% { transform: translate(-2px,0); }
  80% { transform: translate(1px,2px); }
}
@keyframes skull-pulse {
  0%,100% { opacity: 0.12; }
  50% { opacity: 0.25; filter: brightness(1.2) contrast(1.8); }
}
@keyframes title-flicker {
  0%,100% { opacity: 1; }
  48% { opacity: 0.9; }
  50% { opacity: 0.7; }
  52% { opacity: 0.95; }
}
@keyframes prayer-glow {
  0%   { text-shadow: 0 0 4px db.$crimson-glitch-red, 0 0 8px rgba(db.$neon-skull-green, 0.4); }
  50%  { text-shadow: 0 0 12px db.$crimson-glitch-red, 0 0 20px rgba(db.$neon-skull-green, 0.7); }
  100% { text-shadow: 0 0 4px db.$crimson-glitch-red, 0 0 8px rgba(db.$neon-skull-green, 0.4); }
}
